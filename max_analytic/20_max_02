-- author      =     Andreas Buckenhofer 
-- description =     Code to retrieve latest rows from a table containing 
--                   a valid from date but no valid to date

SELECT s.*
FROM   S_CUSTOMER s
WHERE NOT EXISTS (SELECT 1
                  FROM   S_CUSTOMER i
                  WHERE  s.customer_key = i.customer_key
                  AND    s.valid_from < i.valid_from);
                  
SELECT s.*
FROM   S_CUSTOMER s
WHERE  s.valid_from = (SELECT MAX(i.valid_from)
                       FROM S_CUSTOMER i
                       WHERE s.customer_key = i.customer_key);  
