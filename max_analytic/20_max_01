-- author      =     Andreas Buckenhofer 
-- description =     Code to retrieve latest rows from a table containing 
--                   a valid from date but no valid to date

SELECT s.*
FROM   S_CUSTOMER s
JOIN (SELECT i.customer_key,
             max(i.valid_from) as max_valid_from
      FROM S_CUSTOMER i
      GROUP BY i.customer_key) b
ON s.customer_key = b.customer_key 
AND s.valid_from = b.max_valid_from;
